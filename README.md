# SHADE

A font editor under development.

## 画布编辑

### 基本操作

- Ctrl + 鼠标滚动使画布以鼠标位置为锚点缩放
- Alt + 鼠标滚动使画布以中心窗口为锚点缩放
- 按下鼠标中键拖动使画布移动
- ！从标尺上拖动到画布中创建辅助线，将辅助线拖回标尺以删除
- ！双击或右键辅助线设定精确坐标
- ！单击画布左上角锁图案为辅助线上锁或解锁
  - 上锁后辅助线将不响应任何修改动作，仅显示在最前

### 编辑模式

- 节点模式（node）
  - 拖动已创建的节点
    - 按下 Ctrl 键同时拖动已创建的节点，开启吸附模式
      - ！被拖动节点将自动吸附到显示距离相近的节点
      - ！手柄角度自动吸附到可设定的整数 / 对应手柄 / 距离相近节点的手柄角度
      - ！控制点被拖至接近主节点时将隐藏，此时松开鼠标将删除控制点，继续拖离主节点将重新显示
      - ！节点自动吸附到网格，网格大小可设定
  - 控制点平滑设置
    - ！按下 C 键使选中非平滑节点平滑，自动创建控制点
    - ！按下 V 键在 C 基础上使选中节点控制点对称
    - ！按下 X 键取消所有选中节点平滑限制
    - ！按下 Alt 键拖动单个节点，使控制点绝对位置不变，同时将自动取消平滑限制
  - 节点选中设置
    - 鼠标位于节点上时向上或向下滚动，自动增加选中同路径中上游或下游节点
      - ！备选：自动选中或取消选中两侧节点
    - 按下 Ctrl 同时单击节点增加选中，直接单击节点选中当前节点并取消其余所有选中
    - ！按下 Delete 键删除选中节点
    - ！在空白位置单击拖动创建选择框，选中框内所有节点
  - 节点显示范围
    - ！包含选中节点的路径 / 组件 / 字形被视为正在编辑
    - ！主节点显示范围可选项：显示当前正在编辑最低一级组件的所有节点 / 当前正在编辑路径的所有节点 / 屏幕上所有存在路径的节点 / 当前正在编辑字形的所有节点
    - ！控制点显示范围可选项：显示当前选中节点附近的所有控制点 / 显示所有处于显示状态节点附近的所有控制点
  - 编辑范围可选项：锁定当前路径 / 组件


- 钢笔模式（pen）
  - 绘制和创建节点
    - 不处于路径绘制状态下时单击创建节点，同时创建路径并进入路径绘制状态
    - 处于路径绘制状态时单击绘制下一个节点，或按下鼠标右键 / Esc / Enter 退出
    - 处于路径绘制状态下时根据鼠标位置显示绘制预览
    - 按下鼠标左键创建节点之后不松开并拖动，创建控制点，此时为自动平滑且对称状态
    - 创建节点时将自动归属于一个路径，这个路径归属于一个组件
    - 创建节点将取消所有选中并选中新创建节点
      - ！备选：钢笔模式下将不会自动取消其余节点的选中
  - 节点显示范围
    - ！从节点模式切换到钢笔模式时，选中节点，路径和组件的编辑状态将保留
    - ！若没有选择任何节点，则除新创建路径外没有路径正在编辑
    - ！主节点显示范围可选项：显示当前正在编辑最低一级组件的所有节点 / 当前正在编辑路径的所有节点 / 屏幕上所有存在路径的节点 / 当前正在编辑字形的所有节点
    - ！控制点显示范围可选项：显示当前选中节点附近的所有控制点 / 显示所有处于显示状态节点附近的所有控制点
    - ！备选：单击存在节点不会触发拖动，而是在其位置新建一个节点并创建一个钩子
  - ！没有办法直接绘制不连续的路径，必须在选择模式选中两个路径并手动合并

- ！选择模式
  - 最小编辑单位为路径而非节点
  - 双击任何路径将切换至节点模式并编辑该路径
  - 在空白位置单击拖动创建选择框，选中全部位于框内的所有路径
  - 编辑范围可选项：锁定当前路径 / 组件
  - 鼠标拖动控制方框缩放，旋转和移动选中单位
    - 按下 Ctrl 键拖动保持单位宽高比例
    - 可选项：所见即所得模式中，拖动不影响描边宽度

- ！形状模式
  - 可以画圆等用贝塞尔曲线无法表示或操作麻烦的矢量图形
  - 绘制完成后，立即被近似转换成贝塞尔曲线路径


### ！导出模式

- 所见即所得模式
  - 最终字体渲染效果将严格符合编辑时看到的效果（颜色除外），这意味着：
    - 设置的描边宽度将被自动扩展为路径填充
    - 如果路径是开放的，则不会渲染填充
    - 等价于填充模式下手动对所有路径逐一扩展描边
- 仅填充模式
  - 符合传统的字形编辑逻辑，这意味着：
    - 导出的字体将渲染所有路径的填充部分
    - 对路径描边宽度的设置无效
    - 即使路径开放，也会被强行闭合
      - 备选：开放的路径不会被强行闭合，而是被忽略 / 被原样传递至最终字体并在字体渲染时被忽略
    - 可以手动扩展描边，扩展后将作为闭合路径被正常处理

### ！文件格式

- JSON
  - 原生支持格式，推荐使用且被作为浏览器缓存格式
  - 可以导出为不含编辑器设置的纯净版本

- SVG
- UFO
- OTF / TTF
  - 不确定能否实现

### 控制面板